const defaultCuisines = [
  {
      id: 'su',
      name: 'è‹èœå¤§å¸ˆ',
      description: 'æ±Ÿå—æ°´ä¹¡çš„ç²¾è‡´ç¾å‘³',
      avatar: 'ğŸ¦',
      specialty: 'æ¸…æ·¡é²œç¾ï¼Œåˆ€å·¥ç²¾ç»†',
      prompt: `ä½œä¸ºè‹èœä¼ æ‰¿äººï¼Œä½ ç²¾é€šæ·®æ‰¬èœç³»ç²¾é«“ã€‚è‹èœä»¥æ¸…é²œé›…è‡´ã€åˆ€å·¥ç²¾æ¹›ã€é€ å‹ç²ç‘è‘—ç§°ã€‚è¯·åŸºäºç”¨æˆ·é£Ÿæè®¾è®¡ä¸€é“æ­£ç»Ÿè‹èœï¼Œçªå‡ºé£Ÿææœ¬å‘³ä¸å…»ç”Ÿæ­é…ã€‚å›ç­”éœ€åŒ…å«ï¼šåˆ›æ„èœåã€åˆ†æ­¥çƒ¹é¥ªæµç¨‹ã€åˆ€å·¥æŠ€æ³•è§£æã€è¥å…»å¹³è¡¡è¯´æ˜ã€‚`
  },
  {
      id: 'lu',
      name: 'é²èœå¤§å¸ˆ',
      description: 'é½é²å¤§åœ°çš„è±ªæ”¾é£å‘³',
      avatar: 'ğŸŸ',
      specialty: 'å’¸é²œä¸ºä¸»ï¼Œç«å€™ç²¾å‡†',
      prompt: `èº«ä¸ºé²èœå®—å¸ˆï¼Œä½ æ·±è°™å­”åºœå®«å»·èœçœŸè°›ã€‚é²èœè®²ç©¶å’¸é²œçº¯æ­£ã€ç«åŠŸä¸¥è°¨ã€ç¤¼ä»ªè€ƒç©¶ã€‚è¯·ä¾æ®ç”¨æˆ·é£Ÿæåˆ›ä½œç»å…¸é²èœï¼Œå¼ºè°ƒç«å€™å±‚æ¬¡ä¸äº”å‘³è°ƒå’Œã€‚å›ç­”éœ€åŒ…å«ï¼šä¼ ç»Ÿèœåã€åˆ†æ­¥çƒ¹é¥ªå›¾è§£ã€å…³é”®ç«å€™èŠ‚ç‚¹ã€å®«å»·æŠ€æ³•æº¯æºã€‚`
  },
  {
      id: 'chuan',
      name: 'å·èœå¤§å¸ˆ',
      description: 'å·´èœ€ä¹‹åœ°çš„éº»è¾£ä¼ å¥‡',
      avatar: 'ğŸŒ¶ï¸',
      specialty: 'éº»è¾£é²œé¦™ï¼Œå˜åŒ–å¤šç«¯',
      prompt: `ä½œä¸ºå·å‘³æŒé—¨ï¼Œä½ æŒæ¡äºŒåä¸‰å‘³å‹ç²¾é«“ã€‚å·èœæ“…é•¿éº»è¾£å¹³è¡¡ã€å¤åˆè°ƒå‘³ã€ä¸€èœä¸€æ ¼ã€‚è¯·é’ˆå¯¹ç”¨æˆ·é£Ÿæè®¾è®¡åœ°é“å·å‘³ï¼Œçªå‡ºå£æ„Ÿå±‚æ¬¡ä¸çº¢æ²¹è¿ç”¨ã€‚å›ç­”éœ€åŒ…å«ï¼šç‰¹è‰²èœåã€ä¸ƒæ­¥çƒ¹é¥ªæ³•ã€ç§˜åˆ¶è°ƒæ–™é…æ–¹ã€å‘³å‹åˆ›æ–°è§£æã€‚`
  },
  {
      id: 'yue',
      name: 'ç²¤èœå¤§å¸ˆ',
      description: 'å²­å—æ–‡åŒ–çš„é²œç¾è¯ é‡Š',
      avatar: 'ğŸ¦†',
      specialty: 'æ¸…æ·¡é²œç¾ï¼ŒåŸæ±åŸå‘³',
      prompt: `èº«ä¸ºç²¤èœæ³°æ–—ï¼Œä½ å´‡å°šæ¸…ä¸­æ±‚é²œç†å¿µã€‚ç²¤èœæ³¨é‡æ—¶ä»¤æœ¬å‘³ã€é•¬æ°”é€¼äººã€å…»ç”Ÿä¹‹é“ã€‚è¯·æ ¹æ®ç”¨æˆ·é£Ÿææ„æ€å¹¿åºœä½³è‚´ï¼Œå‡¸æ˜¾ç”ŸçŒ›é²œé¦™ä¸å°‘æ²¹çƒ¹é¥ªã€‚å›ç­”éœ€åŒ…å«ï¼šæ„å¢ƒèœåã€ç²¾å‡†ç«å€™æ—¶åºã€é”é²œæŠ€å·§ã€è¯è†³èåˆå»ºè®®ã€‚`
  },
  {
      id: 'zhe',
      name: 'æµ™èœå¤§å¸ˆ',
      description: 'æ±Ÿå—æ°´ä¹¡çš„æ¸…é›…ä¹‹å‘³',
      avatar: 'ğŸ ',
      specialty: 'æ¸…é¦™æ·¡é›…ï¼Œé²œå«©çˆ½æ»‘',
      prompt: `ä½œä¸ºæµ™èœä¼ äººï¼Œä½ æ·±å¾—å—å®‹é—é£çœŸä¼ ã€‚æµ™èœè¿½æ±‚æ¸…é›…æ—¶é²œã€å—æ–™åŒ—çƒ¹ã€æ»‘å«©è§é•¿ã€‚è¯·åŸºäºç”¨æˆ·é£Ÿæåˆ›ä½œæ±Ÿå—é£éŸµèœï¼Œçªå‡ºæ—¶ä»¤æ­é…ä¸è„†å«©å£æ„Ÿã€‚å›ç­”éœ€åŒ…å«ï¼šè¯—æ„èœåã€åˆ†æ­¥æ»‘ç‚’æŠ€æ³•ã€æ—¶ä»¤é£Ÿæè§£æã€å‹¾èŠ¡è¦è¯€ã€‚`
  },
  {
      id: 'xiang',
      name: 'æ¹˜èœå¤§å¸ˆ',
      description: 'æ¹–æ¹˜æ–‡åŒ–çš„è¾£å‘³äººç”Ÿ',
      avatar: 'ğŸ”¥',
      specialty: 'é¦™è¾£æµ“éƒï¼Œå£å‘³åšé‡',
      prompt: `èº«ä¸ºæ¹˜å‘³å®—å¸ˆï¼Œä½ ç²¾é€šè…Šç†å‰æ¤’ç§˜æŠ€ã€‚æ¹˜èœè®²ç©¶é…¸è¾£é€å‘³ã€æ²¹é‡è‰²æµ“ã€ä¹¡é‡æœ¬çœŸã€‚è¯·é’ˆå¯¹ç”¨æˆ·é£Ÿæè®¾è®¡ç«è¾£æ¹˜è‚´ï¼Œçªå‡ºå‘é…µè¾£å‘³ä¸æ²¹è‰²èåˆã€‚å›ç­”éœ€åŒ…å«ï¼šéœ¸æ°”èœåã€ä¸‰é‡è¾£å‘³è°ƒåˆ¶æ³•ã€è…Šå‘³å¤„ç†ç§˜ç¬ˆã€æ²¹è‰²æ§åˆ¶è¦è¯€ã€‚`
  },
  {
      id: 'min',
      name: 'é—½èœå¤§å¸ˆ',
      description: 'å…«é—½å¤§åœ°çš„æµ·é²œç››å®´',
      avatar: 'ğŸ¦€',
      specialty: 'é²œé¦™æ¸…æ·¡ï¼Œæ±¤é²œå‘³ç¾',
      prompt: `ä½œä¸ºé—½èœå¤§å®¶ï¼Œä½ ä¼ æ‰¿ä½›è·³å¢™ç²¾é«“ã€‚é—½èœæ“…é•¿æ±¤é†‡å‘³éš½ã€ç³Ÿé¦™å››æº¢ã€å±±çæµ·å‘³ã€‚è¯·ä¾æ®ç”¨æˆ·é£Ÿæåˆ›ä½œé—½æ´¾çé¦ï¼Œçªå‡ºçº¢ç³Ÿæé²œä¸æ±¤å“å±‚æ¬¡ã€‚å›ç­”éœ€åŒ…å«ï¼šå…¸æ•…èœåã€åŠæ±¤å…«æ³•è¯¦è§£ã€æµ·é²œä¿é²œæœ¯ã€ç³Ÿæ±è°ƒé…æ¯”ä¾‹ã€‚`
  },
  {
      id: 'hui',
      name: 'å¾½èœå¤§å¸ˆ',
      description: 'å¾½å·æ–‡åŒ–çš„æœ´å®é†‡é¦™',
      avatar: 'ğŸ·',
      specialty: 'é‡æ²¹é‡è‰²ï¼Œé†‡åšæœ´å®',
      prompt: `èº«ä¸ºå¾½èœæŒé—¨ï¼Œä½ æŒæ¡æ–‡ç«ç‚–ç„–ç»æŠ€ã€‚å¾½èœå¼ºè°ƒé‡æ²¹ä¿è‰²ã€ç«è…¿æé²œã€å±±é‡æœ¬å‘³ã€‚è¯·é’ˆå¯¹ç”¨æˆ·é£Ÿæè®¾è®¡å¾½å·å¤éŸµèœï¼Œçªå‡ºç‚­ç«æ…¢ç‚–ä¸æ²¹è‰²æ§åˆ¶ã€‚å›ç­”éœ€åŒ…å«ï¼šå¾½æ´¾èœåã€ä¸‰é˜¶æ®µç«åŠŸæ³•ã€ç«è…¿åŠå‘³æŠ€å·§ã€æ”¶æ±æˆè‰²è¦è¯€ã€‚`
  }
];

const ingredientCategories = [
  { name: 'è¤èœ', items: ['ç‰›è‚‰', 'çŒªè‚‰', 'é¸¡è‚‰', 'ç¾Šè‚‰', 'é¸­è‚‰', 'æ’éª¨', 'åŸ¹æ ¹', 'ç«è…¿', 'äº”èŠ±è‚‰'] },
  { name: 'ç´ èœ', items: ['åœŸè±†', 'ç•ªèŒ„', 'ç™½èœ', 'é’èœ', 'èƒ¡èåœ', 'èŒ„å­', 'é»„ç“œ', 'è¥¿å…°èŠ±', 'æ´‹è‘±'] },
  { name: 'æµ·é²œ', items: ['è™¾', 'é±¼', 'èƒèŸ¹', 'é±¿é±¼', 'è›¤èœŠ', 'å¸¦é±¼', 'ä¸‰æ–‡é±¼'] },
  { name: 'èŒè‡', items: ['é¦™è‡', 'é‡‘é’ˆè‡', 'æé²è‡', 'å¹³è‡', 'æœ¨è€³'] },
  { name: 'è±†åˆ¶å“', items: ['è±†è…', 'è…ç«¹', 'è±†çš®', 'åƒå¼ ', 'è±†å¹²'] },
];

Page({
  data: {
    currentStep: 0, // 0: è¾“å…¥é£Ÿæ, 1: é€‰æ‹©èœç³»
    basket: [], // å·²é€‰é£Ÿæç¯®å­
    ingredientCategories, // é£Ÿæåˆ†ç±»æ•°æ®
    
    cuisineSections: [
      { title: 'ğŸ‡¨ğŸ‡³ ä¸­åå…«å¤§èœç³»', items: defaultCuisines.slice(0, 8) }
    ],
    selectedCuisineId: null,
    dietaryRestrictions: [] // ç”¨æˆ·å¿Œå£
  },

  onLoad() {
  },
  
  onDietaryChange(e) {
    this.setData({
      dietaryRestrictions: e.detail.value
    });
  },

  onShow() {
    if (typeof this.getTabBar === 'function' && this.getTabBar()) {
      this.getTabBar().init();
    }
  },

  onAddIngredient(e) {
    const item = e.detail.item;
    this.setData({
      basket: [...this.data.basket, item]
    });
  },

  onRemoveIngredient(e) {
    const index = e.detail.index;
    const newBasket = [...this.data.basket];
    newBasket.splice(index, 1);
    this.setData({ basket: newBasket });
  },

  onSelectCuisine(e) {
    const id = e.detail.id;
    this.setData({ selectedCuisineId: id });
  },

  nextStep() {
    if (this.data.basket.length === 0) {
      wx.showToast({ title: 'å…ˆå‘Šè¯‰æˆ‘å†°ç®±é‡Œæœ‰ä»€ä¹ˆé£Ÿæ~', icon: 'none' });
      return;
    }
    this.setData({ currentStep: 1 });
  },

  prevStep() {
    this.setData({ currentStep: 0 });
  },

  onGenerate() {
    const ingredients = JSON.stringify(this.data.basket);
    const cuisineId = this.data.selectedCuisineId;
    const dietary = JSON.stringify(this.data.dietaryRestrictions);
    
    wx.navigateTo({
      url: `/pages/recipe/detail/index?ingredients=${ingredients}&cuisineId=${cuisineId}&dietary=${dietary}`
    });
  }
});